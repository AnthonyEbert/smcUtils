<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Provides utility functions for sequential Monte Carlo.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css"href="R.css">
</head><body>

<table width="100%" summary="page for smcUtils-package {}"><tr><td>smcUtils-package {}</td><td align="right">R Documentation</td></tr></table>

<h2>Provides utility functions for sequential Monte Carlo.</h2>


<h3>Description</h3>

<p>Contains functions for resampling, evaluating non-uniformity, and normalizing 
particles in sequential Monte Carlo</p>


<h3>Details</h3>

<p>

</p>
<table summary="Rd table">
<tr>
 <td align="left">
Package: </td><td align="left"> smcUtils</td>
</tr>
<tr>
 <td align="left">
Type: </td><td align="left"> Package</td>
</tr>
<tr>
 <td align="left">
Version: </td><td align="left"> 1.0</td>
</tr>
<tr>
 <td align="left">
Date: </td><td align="left"> 2009-11-19</td>
</tr>
<tr>
 <td align="left">
License: </td><td align="left"> GPL</td>
</tr>
<tr>
 <td align="left">
LazyLoad: </td><td align="left"> yes</td>
</tr>
<tr>
 <td align="left">
</td>
</tr>

</table><p>

~~ An overview of how to use the package, including the most important functions ~~
</p>


<h3>Author(s)</h3>

<p>
Author: Jarad Niemi
</p>
<p>
Maintainer: Jarad Niemi &lt;niemi@pstat.ucsb.edu&gt;
</p>


<h3>References</h3>

<p>
Douc, R., Cappe, O.,  Moulines, E. (2005) Comparison of Resampling 
Schemes for Particle Filtering. _Proceedings of the 4th International Symposium 
on Image and Signal Processing and Analysis_
</p>
<p>
Carpenter, J., Clifford, P., Fearnhead, P. An improved particle filter for 
non-linear problems. _IEE proceedings - Radar, Sonar and Navigation_ *146*, 2-7
</p>


<h3>See Also</h3>

<p>
~~ Optional links to other man pages, e.g. ~~
~~ <code>&lt;pkg&gt;</code> ~~
</p>


<h3>Examples</h3>

<pre>
# Generate data from a simple dynamic linear model
N = 100
true.x = rep(NA,N)
true.x[1] = rnorm(1)
for (i in 2:N) true.x[i] = rnorm(1,0.95*true.x[i-1],0.1) # Evolve theta
y = rnorm(N,true.x)                                     # Noisy data

# Run a particle filter to estimate true.x
J = 99
x  = matrix(NA,N,J) 
ws = matrix(NA,N,J)
x[1,]  = rnorm(J) # Sample from the prior for theta
ws[1,] = renormalize.weights(dnorm(y[1],x[1,],log=T))
ess = rep(NA,N)
for (i in 2:N) {
  ess[i-1] = ess.weights(ws[i-1,])
  
  if (ess&lt;0.8*J) {
    ids = stratified.resampling(ws[i-1,])
    tmp.ws = 1/J
  } else {
    tmp.ws = ws[i-1,]
  }
  x[i,] = rnorm(N,0.95*x[i-1,ids],0.1)
  w[i,] = renormalize.weights(log(tmp.ws)+dnorm(y[i],x[i,],log=T)
}

# Plot results
plot(ess)
abline(h=0.8)

plot(true.x)
lines(apply(x*w,2,sum),col='red')
</pre>

<hr><div align="center">[]</div>
</body></html>
